# !pip install transformers
# !pip install datasets

from transformers import pipeline
from datasets import load_dataset
import evaluate

# paraphrase question using backtranslation from different languages
adv_dataset_hy = load_dataset("jalalnb/back_translation_hy_on_small_persian_QA")
adv_dataset_en = load_dataset("jalalnb/back_translation_en_on_small_persian_QA")
adv_dataset_fr = load_dataset("jalalnb/back_translation_fr_on_small_persian_QA")

question_answerer_mbert = pipeline("question-answering", model="arashmarioriyad/mbert_v3", tokenizer="arashmarioriyad/mbert_tokenizer_v3")
question_answerer_parsbert = pipeline("question-answering", model="arashmarioriyad/parsbert_v1", tokenizer="arashmarioriyad/parsbert_tokenizer_v1")

#################### models evaluations on adversarial dataset generated by Backtranslation method ####################
evaluate.evaluate_model(question_answerer_mbert, adv_dataset_hy['validation'])
evaluate.evaluate_model(question_answerer_parsbert, adv_dataset_hy['validation'])

evaluate.evaluate_model(question_answerer_mbert, adv_dataset_en['validation'])
evaluate.evaluate_model(question_answerer_parsbert, adv_dataset_en['validation'])

evaluate.evaluate_model(question_answerer_mbert, adv_dataset_fr['validation'])
evaluate.evaluate_model(question_answerer_parsbert, adv_dataset_fr['validation'])
